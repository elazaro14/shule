<div class="main-content">
    <div class="admin-box" style="max-width:500px; margin:auto;">
        <h3>Register New Teacher</h3>
        <input type="text" id="tName" placeholder="Teacher Full Name" style="width:100%; padding:10px; margin-bottom:10px;">
        <button id="regBtn" class="btn-save" style="width:100%; padding:12px;">Create Account</button>
        <div id="result" style="display:none; margin-top:20px; color:green; font-weight:bold;"></div>
    </div>
</div>

<script type="module">
    import { auth, db } from "./firebase.js";
    import { createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    regBtn.onclick = async () => {
        const name = tName.value;
        const email = name.toLowerCase().replace(/\s/g, '') + "@olmoti.sc.tz";
        const pass = "Olmoti@2025";

        try {
            const res = await createUserWithEmailAndPassword(auth, email, pass);
            await setDoc(doc(db, "users", res.user.uid), {
                name: name,
                email: email,
                role: "teacher",
                assignedClass: "Form 1",
                assignedStream: "A"
            });
            document.getElementById('result').innerText = `Created: ${email} | Pass: ${pass}`;
            document.getElementById('result').style.display = "block";
        } catch (e) { alert(e.message); }
    };
</script>
