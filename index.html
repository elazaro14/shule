import { auth } from "./firebase.js";
import { signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

// --- AUTO LOGOUT LOGIC ---

let logoutTimer;
const TIMEOUT_LIMIT = 15 * 60 * 1000; // 30 minutes in milliseconds

// Function to perform the logout
const performAutoLogout = async () => {
    try {
        await signOut(auth);
        alert("Session expired due to inactivity. Please log in again.");
        window.location.href = "index.html";
    } catch (error) {
        console.error("Error during auto-logout:", error);
    }
};

// Function to reset the timer
const resetTimer = () => {
    clearTimeout(logoutTimer);
    logoutTimer = setTimeout(performAutoLogout, TIMEOUT_LIMIT);
};

// Events that indicate user activity
const activityEvents = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart'];

// Listen for activity to reset the timer
activityEvents.forEach(event => {
    document.addEventListener(event, resetTimer, true);
});

// Start the timer when the script loads
resetTimer();
