<!DOCTYPE html>
<html>
<head>
    <title>Dashboard | Shule ERP</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<nav>
    <span id="user-display"></span>
    <button onclick="logout()" style="width: auto; float: right;">Logout</button>
</nav>

<div class="center">
    <h2>ðŸ“Š School Management Dashboard</h2>
    <p id="info"></p>

    <div class="cards" id="menu-cards">
        </div>
</div>

<script type="module">
    // Protection: Redirect if not logged in
    const role = sessionStorage.getItem("role");
    const user = sessionStorage.getItem("user");

    if (!role) {
        window.location.href = "index.html";
    }

    document.getElementById("info").innerText = `Access Level: ${role.toUpperCase()}`;
    document.getElementById("user-display").innerText = `Logged in as: ${user}`;

    const menuContainer = document.getElementById("menu-cards");

    // Define features for each role
    const features = [
        { title: "Student Reports", link: "reports.html", roles: ["admin", "teacher"], icon: "ðŸ“‘" },
        { title: "Parent SMS", link: "sms.html", roles: ["admin"], icon: "ðŸ“©" },
        { title: "Timetable", link: "timetable.html", roles: ["admin", "teacher"], icon: "ðŸ“…" }
    ];

    // Filter and display cards based on role
    features.forEach(f => {
        if (f.roles.includes(role.toLowerCase())) {
            const card = document.createElement("div");
            card.className = "card";
            card.innerHTML = `
                <h3>${f.icon}</h3>
                <h4>${f.title}</h4>
                <button onclick="location.href='${f.link}'">Open</button>
            `;
            menuContainer.appendChild(card);
        }
    });

    // Global logout function
    window.logout = function() {
        sessionStorage.clear();
        window.location.href = "index.html";
    };
</script>

</body>
</html>
