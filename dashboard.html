<div class="sidebar">
    <h2>Olmoti School</h2> <a href="dashboard.html" class="nav-link active"><i class="fas fa-chart-line"></i> Dashboard</a> <a href="add-student.html" class="nav-link"><i class="fas fa-user-plus"></i> Add Student</a>
    <a href="reports.html" class="nav-link"><i class="fas fa-edit"></i> Mark Entry</a>
    <a href="view-report.html" class="nav-link"><i class="fas fa-file-invoice"></i> View Reports</a>
    <button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</button> </div>

<script type="module">
    import { db, auth } from "./firebase.js"; //
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"; //
    import { collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"; //

    onAuthStateChanged(auth, (user) => {
        if (user) { loadAllData(); } //
        else { window.location.href = "index.html"; } //
    });

    async function loadAllData() {
        // Fetch Students and Teachers counts based on the 'sex' field
        updateStats("students", "sTotal", "sMale", "sFemale");
        updateStats("teachers", "tTotal", "tMale", "tFemale");
    }

    async function updateStats(col, totalId, mId, fId) {
        const snap = await getDocs(collection(db, col)); //
        let t = 0, m = 0, f = 0;
        snap.forEach(doc => {
            t++;
            const sex = (doc.data().sex || "").toUpperCase(); //
            if (sex.startsWith("M")) m++; //
            else if (sex.startsWith("F")) f++; //
        });
        document.getElementById(totalId).innerText = t; //
        document.getElementById(mId).innerText = m; //
        document.getElementById(fId).innerText = f; //
    }
</script>
