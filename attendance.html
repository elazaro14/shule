<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Attendance | Olmoti</title>
    <style>
        :root { --primary: #1a237e; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; display: flex; }
        .sidebar { width: 260px; background: var(--primary); color: white; height: 100vh; position: fixed; }
        .main { margin-left: 260px; padding: 40px; width: 100%; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .student-row { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #eee; }
        .btn-p { background: green; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 4px; }
        .btn-a { background: red; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div style="padding:20px; text-align:center;"><h2>OLMOTI</h2></div>
        <ul style="list-style:none; padding:0;">
            <li style="padding:15px;"><a href="dashboard.html" style="color:white; text-decoration:none;">üè† Dashboard</a></li>
        </ul>
    </div>
    <div class="main">
        <h1>Daily Attendance</h1>
        <div class="card" id="list">Loading students...</div>
    </div>

    <script type="module">
        import { db, auth } from "./firebase.js";
        import { collection, query, where, getDocs, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        onAuthStateChanged(auth, async (user) => {
            if (!user) window.location.href = "index.html";
            const uSnap = await getDoc(doc(db, "users", user.uid));
            const cls = uSnap.data().assignedClass;
            
            const q = query(collection(db, "students"), where("cls", "==", cls));
            const sSnap = await getDocs(q);
            const listDiv = document.getElementById('list');
            listDiv.innerHTML = "";
            sSnap.forEach(sDoc => {
                listDiv.innerHTML += `
                    <div class="student-row">
                        <span>${sDoc.data().name}</span>
                        <div>
                            <button class="btn-p">Present</button>
                            <button class="btn-a">Absent</button>
                        </div>
                    </div>`;
            });
        });
    </script>
</body>
</html>
